Фикс Frontend-логики и UI
Задание: Исправление критических багов Frontend (V2 Phase 1.1)

База данных обновлена (RLS политики и права админа прописаны). Необходимо внести следующие правки в код приложения:

1. Исправление редиректа в AdminPanel:

В компоненте AdminPanel.tsx (или в защищенном роуте) убедись, что проверка is_admin происходит после того, как профиль пользователя полностью загружен из Supabase.

Добавь состояние loading, чтобы приложение не выкидывало пользователя на главную, пока статус is_admin еще подгружается.

2. Фикс удаления комментариев:

Убедись, что функция удаления в comments.service.ts использует метод .delete(), а не пытается просто обновить поле, если это не предусмотрено логикой "мягкого удаления".

Проверь, что в CommentItem.tsx кнопка удаления отображается корректно: (user.id === comment.user_id || profile.is_admin).

3. Исправление прокрутки (Scrolling Issue):

Проверь файл App.tsx или основной Layout-контейнер. Нужно найти и удалить overflow: hidden или max-height: 100vh, которые ограничивают высоту страницы.

Добавь в глобальный CSS:

CSS
html, body { height: auto !important; overflow-y: visible !important; }
#root { min-height: 100vh; display: flex; flex-direction: column; }
4. Инвалидация кэша (React Query):

После удаления комментария добавь queryClient.invalidateQueries(['comments']), чтобы список обновлялся мгновенно без перезагрузки страницы.

5. Логирование для отладки:

Если админка всё еще не пускает, добавь console.log('Current profile:', profile) в компонент профиля, чтобы мы видели, приходит ли флаг is_admin: true с сервера.


ИЗУЧИ ПРОЕКТ ПЕРЕД НАЧАЛОМ